Vue.component("stencil-param",{props:["uploaddata"],template:"#stencil-param-list",data:function(){return{stencilData:{},this_stencil:{s_dimensions_value:0,s_dimensions_name:"",s_qty:1,s_fiducial:{},s_thickness:{},s_polishing:{},stencil_price:0,stencil_org_price:0,stencil_weight:0,stencil_file_name:"",stencil_file_number:""}}},created:function(){},ready:function(){var e=this;this.getStencilParamData(function(t){e.stencilData=t.data;for(i in e.stencilData)for(var a in e.stencilData[i])1==e.stencilData[i][a].state&&(e.this_stencil["s_"+i]=e.stencilData[i][a]);e.this_stencil.s_dimensions_name="28.0cm * 38.0cm Frameless - eff.19*29",e.this_stencil.s_dimensions_value=1,e.getStencilPrice(),setTimeout(function(){var e=$(".stencil-dimensions");e.prepend('<optgroup label="* Frameless">'),$('<optgroup label="* Framed">').insertBefore(e.find("option").eq(2))})})},methods:{setDimensions:function(e){var t=$(e.target).find("option:selected").text();this.this_stencil.s_dimensions_name=t,this.getStencilPrice()},setStencilQty:function(e){var t=e.target;t.value=t.value.replace(/[^\d]/g,""),t.value=t.value.replace(/^\./g,""),t.value<=0&&(t.value=1),this.getStencilPrice()},setFiducialMark:function(e,t){return 2!=t&&(this.this_stencil.s_fiducial=e,void this.getStencilPrice())},setStencilThickness:function(e,t){return 2!=t&&(this.this_stencil.s_thickness=e,void this.getStencilPrice())},setStencilPolishing:function(e,t){return 2!=t&&(this.this_stencil.s_polishing=e,void this.getStencilPrice())},getStencilParamData:function(e){startAjax(seeedApiURL.getStencilParam+"?lang="+FUSION_LANG,"format=2",function(t){0==t.code&&e(t),0!=t.code})},getStencilPrice:function(){var e=this,t=seeedApiURL.getStencilPrice+getRealToken(!1)+"&lang="+FUSION_LANG,i="qty="+this.this_stencil.s_qty+"&fiducial="+this.this_stencil.s_fiducial.value+"&dimension="+this.this_stencil.s_dimensions_value+"&thickness="+this.this_stencil.s_thickness.value+"&polishing="+this.this_stencil.s_polishing.value;startAjax(t,i,function(t){0==t.code&&(e.this_stencil.stencil_price=t.data.price,e.this_stencil.stencil_org_price=t.data.price_original,e.this_stencil.stencil_weight=t.data.weight)})}},watch:{this_stencil:{deep:!0,handler:function(){this.$dispatch("STENCIL_param_data",this.this_stencil)}}},events:{STENCIL_file_data:function(e){this.this_stencil.stencil_file_name=e.fileName,this.this_stencil.stencil_file_number=e.fileNumber}}}),fusion.fusionAction=function(){new Vue({el:"#new-fusion",data:{msg:"hello vaan",is_login:"",pcb_board:{},type_data_1:[],type_data_2:[],type_data_3:[],nowPcbType:1,user_choose_data_1:{},user_choose_data_2:{},user_choose_data_3:{},user_chose_data_temp:{},pcb_data:{},pcbFileKey:"",isEditedGerberSize:!1,pcb_upload_data:JSON.parse(PCB_UPLOAD_DATA),other_upload_data:JSON.parse(OTHER_UPLOAD_DATA),pcb_price:0,pcb_get_price_param:"",PCB_file_name:"",PCB_file_id:"",PCB_file_gerber_width:0,PCB_file_gerber_length:0,PCB_file_gerber_layer:0,OTHER_file_name:"",OTHER_file_id:"",OTHER_file_url:"",pcb_pid:835,pcba_pid:1511,stencil_pid:1391,isOpenBom:!1,bomQty:10,bomToken:"",bomServer:"A",bomOplResult:{},bomNotOplResult:{},bomOfferPrice:{},bomResultCount:0,bomMultiResult:{},isBomUploaded:!1,bomEnquiryResult:{},bomEnquiryCount:0,bomProvideResult:{},bomProvideCount:0,isBomAnalysis:!1,isBomAnalysisError:!1,isBomAnalysisDes:"",isBomQtyWarn:!1,bomPrice:{componentsCost:0,componentsCostOrigin:0,setupCost:0,setupCostOrigin:0,assemblyCost:0,assemblyCostOrigin:0,consumptiveMaterialCost:0,consumptiveMaterialCostOrigin:0,OperationFeePrice:0,OperationFeePriceOrigin:0,expeditedCostOrigin:0,DFACostOrigin:0,DFACostCurrent:0,bomTotalCost:0,bomTotalCostOrigin:0,bom_total_price:0,bom_build_time_orig:0,bom_build_time_curr:0,expeditedBuildTime:"7-15",DFABuildTime:"2",bom_weight:0,bom_and_pcb_rog_price:0,bom_and_pcb_price:0,bom_and_pcb_price_origin:0},bom_upload_data:JSON.parse(BOM_UPLOAD_DATA),bomErrorCode:[2106,2170,2281,2282,2283,2284,2285,2286,2287,2288,2289,2290,2291,2292,2293,2294],pcba_test:!1,bom_test_upload_data:JSON.parse(BOM_TEST_UPLOAD_DATA),pcba_test_file_id:"",isOpenStencil:!1,stencil_upload_data:JSON.parse(STENCIL_UPLOAD_DATA),stencilResult:{},finalPrice:0,finalOrgPrice:0,finalWeight:0,finalBuildTime:0,id:!1,popData:{msg:"hello vaan",isShow:!1,popText:"Seeed Fusion",popHTML:"",isFullModalShow:!1,fullModalResultType:"",fullModalText:"",isActionModalShow:!1,actionModalText:"",is5FreeActionModalShow:!1,action5FreeModalText:"",isLoginActionModalShow:!1,isConfirmModalShow:!1,confirmModalTitle:"",confirmModalHtml:"",isNeedCloseBtn:!1,isSetBtnText:"",isLoadingShow:!1},currState:!1,expeditedVal:2,orderAgain:{gerberState:!1,gerberSrc:"",bomState:!1,bomSrc:""},loginBoxOption:{isShow:!1},fusion_add_cart_api:"",fusion_add_cart_param:"",firstLoginQuery:!1,xmas2017:{state:!1,fusionTotalOfCart:0,remainingPrice:0,discount:0,borderPrice:0,currentTotal:0},isAddingCart:"",isAddCart:!1,expedited:"",isExpedited:2,isDfa:2,btContent:"Add to Cart"},created:function(){var e=this;window.fusion.commonState.currentOrderPcbType=e.nowPcbType,$.cookie("local_lang")&&(FUSION_LANG=$.cookie("local_lang")),setTimeout(function(){$.cookie("local_lang_type")&&$(".j-sel-lang").text($.cookie("local_lang_type"))},500),FUSION_LANG||(FUSION_LANG="en",$(".j-sel-lang").text("English")),this.pcb_upload_data.api=seeedApiURL.gerberUpload+"?type=1&lang="+FUSION_LANG,this.other_upload_data.api=seeedApiURL.fileUpload+"?type=1&lang="+FUSION_LANG,this.stencil_upload_data.api=seeedApiURL.gerberUpload+"?type=2&lang="+FUSION_LANG,this.bom_test_upload_data.api=seeedApiURL.testPlanUpload+"?type=2&lang="+FUSION_LANG,this.getPcbParamData(1,2,function(t){e.type_data_1=t,e.type_data_1.pcb_type=1}),this.bom_upload_data.api=seeedApiURL.bomUpload+getRealToken(!1)+"&lang="+FUSION_LANG,getQuery("source")&&(this.orderAgain.gerberState=!0,this.orderAgain.gerberSrc=getQuery("source"),this.reOrderGerber()),getQuery("bomsource")&&(this.orderAgain.bomState=!0,this.orderAgain.bomSrc=getQuery("bomsource"),this.reOrderBom()),window.isOnline(function(t){e.is_login=t.data.is_online})},ready:function(){var e=this,t=$(".j-p-list");t.eq(0).fadeIn(100),$(".j-eg").hover(function(){$(this).find(".eg-img").fadeIn(100)},function(){$(this).find(".eg-img").hide()}),this.setBomComponent(),this.setBomLink(),$(".j-temp-help").hover(function(){$(this).closest(".pcb-help").find(".j-temp-table").fadeIn(100)},function(){$(this).closest(".pcb-help").find(".j-temp-table").hide()}),$("body").on("mouseover",".j-gerber-size-tips",function(){$(this).find(".gerber-size-tips").fadeIn(200)}),$("body").on("mouseleave",".j-gerber-size-tips",function(){$(this).find(".gerber-size-tips").hide()}),setTimeout(function(){window.location.href.indexOf("1-usd-for-3-pcbs")==-1&&$(".js-shop-nav").find("a").eq(2).addClass("on")},1e3),$("body").on("click",".j-f-curr",function(){setTimeout(function(){e.currState=!e.currState},1e3)}),$("body").on("click","#PCB_upload .webuploader-element-invisible",function(){var e=$(this);return!e.hasClass("j-w-up")&&(e.addClass("j-w-up"),void setTimeout(function(){e.removeClass("j-w-up")},3e3))});var i=setInterval(function(){0!=$("#fusion-header").length&&(clearInterval(i),window.fusion.getFusionLanguage())},500),a=window.location.href.indexOf("1-usd-for-3-pcbs.html")>-1;a&&$("body").createConfirmPot({id:"pcb-size-pop",clazz:"js-single-btn",title:"The maximum dimensions for special $1 boards is 100 x 100mm.",confirm:!1}),$("body").on("blur",".j-comp-link",function(){var e=$(this);""!=$.trim($(this).val)&&e.hasClass("animated")&&e.removeAttr("style").removeClass("animated flash")}),startAjax(seeedApiURL.fusionActiveState,"key=Christmas-20171201",function(t){if(0==t.code&&1==t.data.status&&(e.xmas2017.state=!0),0==t.code&&0==t.data.status&&(e.xmas2017.state=!1),0==t.code&&t.data.status==-1)return!1;if(e.xmas2017.state){var i=window.localStorage;window.localStorage.setItem("fusionProductTotalInCart",0);var a=setInterval(function(){0!=i.getItem("fusionProductTotalInCart")&&(clearInterval(a),e.xmas2017.fusionTotalOfCart=i.getItem("fusionProductTotalInCart"),window.localStorage.removeItem("fusionProductTotalInCart"))},200)}})},methods:{switchPcbType:function(e,t,i){var a=this;if(1==e&&a.getPcbParamData(1,2,function(e){a.type_data_1=e,a.type_data_1.pcb_type=1}),2==e&&a.getPcbParamData(2,1,function(e){a.type_data_2=e,a.type_data_2.pcb_type=2}),3==e&&a.getPcbParamData(3,1,function(e){a.type_data_3=e,a.type_data_3.pcb_type=3}),this.pcb_board.value=e,this.pcb_board.name=t,$(i.target).hasClass("selecter-disable"))return!1;switch(this.nowPcbType=e,window.fusion.commonState.currentOrderPcbType=e,$(".j-material-name").text(t),Number(this.nowPcbType)){case 1:this.user_chose_data_temp=this.user_choose_data_1;break;case 2:this.user_chose_data_temp=this.user_choose_data_2;break;case 3:this.user_chose_data_temp=this.user_choose_data_3}},openBom:function(){var e=this;this.isOpenBom=!this.isOpenBom,this.$broadcast("bomOpenState",this.isOpenBom,this.nowPcbType),1==e.isOpenBom&&(this.expeditedVal=2)},checkBomCount:function(e){var t=e.target;t.value=t.value.replace(/[^\d]/g,""),t.value=t.value.replace(/^\./g,"")},refreshBomDetail:function(e){var t=this,i=Number(e.target.value),a=e.target;return 0!=a.value&&""!=a.value||(a.value=1,t.bomQty=1),i>Number(t.user_chose_data_temp.pcb_qty.value)?t.isBomQtyWarn=!0:t.isBomQtyWarn=!1,!!this.isBomUploaded&&void t.getBomDetailAgain()},getBomPrice:function(){var e=this;e.btContent="Calculateing...";var t="impedance="+this.user_chose_data_temp.pcb_impedance.value+"&surface="+this.user_chose_data_temp.pcb_surface.value+"&min_solder_mask_dam="+this.user_chose_data_temp.pcb_min_solder_mask_dam.value+"&copper="+this.user_chose_data_temp.pcb_copper.value+"&half_hole="+this.user_chose_data_temp.pcb_half_hole.value+"&min_hole="+this.user_chose_data_temp.pcb_min_hole.value+"&color="+this.user_chose_data_temp.pcb_color.value+"&board="+this.nowPcbType+"&layer="+this.user_chose_data_temp.pcb_layer.value+"&qty="+this.user_chose_data_temp.pcb_qty.value+"&blind_vias="+ +this.user_chose_data_temp.pcb_blind_vias.value+"&thickness="+this.user_chose_data_temp.pcb_thickness.value+"&min_tracking_spacing="+this.user_chose_data_temp.pcb_min_tracking_spacing.value+"&panelized="+this.user_chose_data_temp.pcb_panelized.value+"&dimension_w="+this.user_chose_data_temp.pcb_dimension_w.value/10+"&dimension_h="+this.user_chose_data_temp.pcb_dimension_h.value/10+"&pcba_expedited="+this.isExpedited+"&dfa_service="+this.isDfa,i=seeedApiURL.getBomPrice+getRealToken(!1)+"&lang="+FUSION_LANG,a=t+"&bom_key="+this.bomToken+"&pcba_qty="+this.bomQty+"&pid=1511";startAjax(i,a,function(t){0==t.code&&(e.btContent="Add to Cart",e.bomPrice.componentsCost=t.data.bom_total.price_component,e.bomPrice.setupCost=t.data.bom_total.price_startup,e.bomPrice.assemblyCost=t.data.bom_total.price_assembly,e.bomPrice.consumptiveMaterialCost=t.data.bom_total.price_consumptive,e.bomPrice.OperationFeePrice=t.data.bom_total.price_operation,e.bomPrice.componentsCostOrigin=t.data.bom_total.price_original_component,e.bomPrice.setupCostOrigin=t.data.bom_total.price_original_startup,e.bomPrice.assemblyCostOrigin=t.data.bom_total.price_original_assembly,e.bomPrice.consumptiveMaterialCostOrigin=t.data.bom_total.price_original_consumptive,e.bomPrice.OperationFeePriceOrigin=t.data.bom_total.price_original_operation,e.bomPrice.expeditedCostOrigin=t.data.bom_total.price_pcba_expedited,e.bomPrice.DFACostOrigin=t.data.bom_total.price_original_dfa_service,e.bomPrice.DFACostCurrent=t.data.bom_total.price_dfa_service,e.bomPrice.bom_and_pcb_price=t.data.sub_total.price,e.bomPrice.bom_and_pcb_price_origin=t.data.sub_total.price_original,e.bomPrice.bomTotalCost=t.data.bom_total.price,e.bomPrice.bomTotalCostOrigin=t.data.bom_total.price_original,e.bomPrice.bom_and_pcb_rog_price=t.data.sub_total.price_original,e.bomPrice.bom_build_time_orig=t.data.sub_total.build_original_time,e.bomPrice.bom_build_time_curr=t.data.sub_total.build_time,e.bomPrice.expeditedBuildTime=t.data.sub_total.build_time_pcba,e.bomPrice.DFABuildTime=t.data.sub_total.build_time_pcba,e.bomPrice.bom_weight=$.formatFloatTo2(t.data.sub_total.weight))})},getBomDetail:function(e){var t=this,i=seeedApiURL.getReBomDetail+getRealToken(!1)+"&lang="+FUSION_LANG,a="pcba_qty="+this.bomQty+"&bom_key="+this.bomToken+"&server="+this.bomServer;t.bomResult={},t.bomEnquiryResult={},t.bomNoItemCount=0,t.isBomAnalysis=!0,t.isBomAnalysisError=!1,startAjax(i,a,function(i){if(0==i.code){t.bomServer=i.data.support_server_default,$(".bom-server-list").find(".j-ser").removeClass("selecter-on");for(var a in t.bomServerType)t.bomServerType[a].use=!1;t.bomMultiResult=i.data.list_multi_price,t.bomOplResult=i.data.list_opl_price,t.bomNotOplResult=i.data.list_nopl_price,t.bomOfferPrice=i.data.list_offer_price,t.bomEnquiryCount=0,0!=i.data.list_enquiry_price.length&&(t.bomEnquiryCount=i.data.list_enquiry_price.length,t.bomEnquiryResult=i.data.list_enquiry_price),0!=i.data.list_provide_price.length&&(t.bomProvideCount=i.data.list_provide_price.length,t.bomProvideResult=i.data.list_provide_price),t.bomResultCount=1*i.data.list_opl_price.length+1*i.data.list_nopl_price.length+1*i.data.list_multi_price.length+1*i.data.list_offer_price.length,t.getBomDetailAgain(),t.rememberBOMChoose(),t.getBomPrice(),t.isBomUploaded=!0,t.isBomAnalysis=!1,e&&e(i)}0!=i.code&&(2281==i.code&&(t.isBomAnalysisDes="We can't parse the BOM file, please modify the format  according to the template."),2282==i.code&&(t.isBomAnalysisDes="We can't parse the BOM file because there is no data in the file, please check and reupload. "),t.isBomAnalysis=!1,t.isBomAnalysisError=!0)})},getBomDetailAgain:function(){var e=this,t="pcba_qty="+this.bomQty+"&bom_key="+this.bomToken+"&server="+this.bomServe,i=seeedApiURL.getBomDetail+getRealToken(!1)+"&lang="+FUSION_LANG;e.isBomAnalysis=!1,e.popData.isLoadingShow=!0,startAjax(i,t,function(t){if(0==t.code){e.bomServer=t.data.support_server_default,$(".bom-server-list").find(".j-ser").removeClass("selecter-on");for(var i in e.bomServerType)e.bomServerType[i].use=!1;e.bomMultiResult=t.data.list_multi_price,e.bomOplResult=t.data.list_opl_price,e.bomNotOplResult=t.data.list_nopl_price,e.bomOfferPrice=t.data.list_offer_price,e.bomEnquiryCount=0,0!=t.data.list_enquiry_price.length&&(e.bomEnquiryCount=t.data.list_enquiry_price.length,e.bomEnquiryResult=t.data.list_enquiry_price),0!=t.data.list_provide_price.length&&(e.bomProvideCount=t.data.list_provide_price.length,e.bomProvideResult=t.data.list_provide_price),e.bomResultCount=1*t.data.list_opl_price.length+1*t.data.list_nopl_price.length+1*t.data.list_multi_price.length+1*t.data.list_offer_price.length,e.rememberBOMChoose(),e.getBomPrice(),e.popData.isLoadingShow=!1,e.isBomUploaded=!0}})},rememberBOMChoose:function(){var e=this;setTimeout(function(){return 0!=$(".j-bom-used").length&&void $(".j-bom-used").each(function(){var t=$(this),i=t.attr("data-use"),a=t.closest(".j-comp-tr"),o=a.find(".alternative-bom-list");o.find(".j-set-comp").each(function(){var t=$(this),s=t.attr("data-com-id");if(s==i){var r=t.closest("tr").find(".j-des").text(),n=t.attr("data-unit-price"),c=t.attr("data-qty"),l=t.attr("data-wq");a.find(".j-s-sku").text("508000001"),a.find(".j-s-dis").text(r),a.find(".j-s-uprice").text(n),a.find(".j-all-price").text((n*(e.bomQty*c+1*l)).toFixed(2)),a.find(".j-s-wq").text(l),o.hide(),a.find(".j-list-arr").find(".fa").removeClass("fa-angle-up").addClass("fa-angle-down")}})})},500)},setBomComponent:function(e){var t=this,i=$("body"),a=seeedApiURL.setBomComponent+getRealToken(!1)+"&lang="+FUSION_LANG;i.on("click",".j-set-comp",function(){var e=$(this),i=(e.closest(".alternative-bom-list"),e.closest(".j-comp-tr")),o=i.find(".j-comp-check"),s=e.attr("data-com-id"),r={};r.mpn=e.attr("data-mpn"),r.sku=e.attr("data-sku"),r.description=e.attr("data-description"),r.unit_price=e.attr("data-unit-price"),r.waste_qty=e.attr("data-wq"),r.qty=e.attr("data-qty"),r.lead_time=e.attr("data-time");var n="c_id="+s+"&mpn="+encodeURIComponent(e.attr("data-mpn"))+"&bom_key="+t.bomToken;return startAjax(a,n,function(e){if(0==e.code){i.attr("data-select-id",s),o.is(":checked")||o.prop("checked","checked"),i.find(".j-s-mpn").text(r.mpn),i.find(".j-s-sku").text(r.sku),i.find(".j-s-dis").text(r.description),i.find(".j-s-uprice").text(r.unit_price),i.find(".j-s-wq").text(r.waste_qty),i.find(".j-lead-time").text(r.lead_time);var a=(r.qty*t.bomQty+1*r.waste_qty)*r.unit_price;i.find(".j-s-allprice").text(a.toFixed(2)),r=null,t.getBomPrice(),i.find(".j-list-arr").click()}}),!1}),i.on("click",".j-comp-check",function(){var e=$(this),i=e.closest(".j-comp-tr"),o=e.attr("data-mpn"),s=i.attr("data-select-id");if(""==s)return t.popData.isShow=!0,t.popData.msg="Please select component first",!1;var r="";r=e.is(":checked")?"c_id="+s+"&mpn="+o+"&bom_key="+t.bomToken:"c_id=0&mpn="+o+"&bom_key="+t.bomToken,startAjax(a,r,function(e){return t.getBomPrice(),!0})}),i.on("click",".j-list-arr",function(){var e=$(this);$list=e.closest(".j-meta-list").find(".alternative-bom-list"),$list.is(":visible")?($list.hide(),e.find(".fa").removeClass("fa-angle-up").addClass("fa-angle-down")):($list.show(),e.find(".fa").removeClass("fa-angle-down").addClass("fa-angle-up"))})},setBomLink:function(){var e=this,t=$("body");t.on("focusin focusout",".j-comp-link",function(e){"focusin"==e.type&&$(this).parent().addClass("input-heighline"),"focusout"==e.type&&$(this).parent().removeClass("input-heighline")}),t.on("click",".j-set-comp-link",function(){var t=$(this),i=0,a=t.closest(".j-noitem-comp").find(".j-comp-link"),o=t.closest(".custom-table"),s=$.trim(a.val()),r=t.attr("data-flag");if(t.is(":checked")){if(""==s)return e.popData.isShow=!0,e.popData.msg="Please fill in the purchase link first",!1;i=1}var n=seeedApiURL.setBomCompLink+getRealToken(!1)+"&lang="+FUSION_LANG,c="flag="+encodeURIComponent(r)+"&product_url="+encodeURIComponent(s)+"&is_enquiry="+i+"&bom_key="+e.bomToken;startAjax(n,c,function(t){0==t.code&&(o.find(".j-set-comp-link").removeAttr("disabled"),e.getBomPrice())})})},setBomTest:function(){var e=this;e.popData.isConfirmModalShow=!0,e.popData.isNeedCloseBtn=!0,e.popData.isSetBtnText="Functional Test",e.popData.confirmModalHtml="We highly recommend you to choose functional test to guarantee the quality of your products since it is over 50 pieces PCBA",e.popData.actionModalOption={type:"pcbaTest"}},openLogin:function(){this.loginBoxOption.isShow=!0,this.loginBoxOption.type="normal"},openStencil:function(){this.isOpenStencil=!this.isOpenStencil},getPcbParamData:function(e,t,i){var a=window.location.href.indexOf("1-usd-for-3-pcbs.html")>-1,o=seeedApiURL.getPcbParam,s=a?"board="+e+"&layer="+t+"&format=2&project=4":"board="+e+"&layer="+t+"&format=2&project=0";1==e&&getQuery("id")&&(o=seeedApiURL.getGalleryParam,s+="&id="+getQuery("id")),startAjax(o+"?lang="+FUSION_LANG,s,function(e){0==e.code&&i&&i(e.data)})},openLogin2:function(){this.popData.isLoginActionModalShow=!0,this.id=!0,this.popData.isLoginActionModalTitle="";var e={type:"login",cancelAction:"login"};return this.popData.actionModalOption=e,!1},handleExpeditedClick:function(){this.isExpedited=2==this.isExpedited?1:2,""!==this.bomToken&&this.getBomPrice()},handleDfaClick:function(){this.isDfa=2==this.isDfa?1:2,""!==this.bomToken&&this.getBomPrice()},addCart:function(){var e=this;return e.isAddCart=!0,!e.isAddingCart&&void isOnline(function(t){if(e.isOpenBom&&!t.data.is_online)return e.isAddCart=!1,void e.openLogin2();e.fusion_add_cart_api=seeedApiURL.addFusionToCart+getRealToken(t.data.is_online)+"&lang="+FUSION_LANG,""==e.user_chose_data_temp.expedited_option_data&&(e.expeditedVal=2);var i='{"impedance":'+e.user_chose_data_temp.pcb_impedance.value+',"surface":'+e.user_chose_data_temp.pcb_surface.value+',"min_solder_mask_dam":'+e.user_chose_data_temp.pcb_min_solder_mask_dam.value+',"copper":'+e.user_chose_data_temp.pcb_copper.value+',"half_hole":'+e.user_chose_data_temp.pcb_half_hole.value+',"min_hole":'+e.user_chose_data_temp.pcb_min_hole.value+',"color":'+e.user_chose_data_temp.pcb_color.value+',"board":'+e.nowPcbType+',"layer":'+e.user_chose_data_temp.pcb_layer.value+',"qty":'+e.user_chose_data_temp.pcb_qty.value+',"blind_vias":'+e.user_chose_data_temp.pcb_blind_vias.value+',"thickness":'+e.user_chose_data_temp.pcb_thickness.value+',"min_tracking_spacing":'+e.user_chose_data_temp.pcb_min_tracking_spacing.value+',"panelized":'+e.user_chose_data_temp.pcb_panelized.value+',"expedited_option":'+e.expeditedVal+',"dimension_w":'+e.user_chose_data_temp.pcb_dimension_h.value/10+',"dimension_h":'+e.user_chose_data_temp.pcb_dimension_w.value/10+"}";if(""==e.PCB_file_name)return e.pcb_upload_data.is_warn=!0,e.isAddCart=!1,window.fusion.positionWarining("#"+e.pcb_upload_data.type+"_upload"),!1;if(e.user_chose_data_temp.pcb_size_error)return e.isAddCart=!1,window.fusion.positionWarining(".j-pcb-"+e.nowPcbType+"-size"),!1;e.fusion_add_cart_param="param="+i+"&pid="+e.pcb_pid+"&qty="+e.user_chose_data_temp.pcb_qty.value+"&price="+e.user_chose_data_temp.pcb_price+"&file="+e.PCB_file_name+"&file_id="+e.PCB_file_id;var a=window.location.href.indexOf("1-usd-for-3-pcbs.html")>-1;if(a&&(e.fusion_add_cart_param+="&project=4"),e.isOpenBom){var o="";if(!e.isBomUploaded)return e.bom_upload_data.is_warn=!0,e.isAddCart=!1,window.fusion.positionWarining("#"+e.bom_upload_data.type+"_upload"),!1;if(e.pcba_test&&!e.pcba_test_file_id)return e.isAddCart=!1,e.bom_test_upload_data.is_warn=!0,window.fusion.positionWarining("#"+e.bom_test_upload_data.type+"_upload"),!1;if(Number(e.bomQty)>Number(e.user_chose_data_temp.pcb_qty.value))return e.isAddCart=!1,window.fusion.positionWarining(".j-bom-qty"),e.isBomQtyWarn=!0,!1;if(0!=e.bomEnquiryCount){var s=seeedApiURL.setMultiBomCompLink+getRealToken(!1)+"&lang="+FUSION_LANG,r="is_enquiry=1&bom_key="+e.bomToken,n=[];$(".j-set-comp-link").each(function(){var e=$(this);n.push('{"flag":"'+e.attr("data-flag")+'","product_url":"'+$.trim(e.closest(".j-noitem-comp").find(".j-comp-link").val())+'"}')}),r+="&multi=["+n.join(",")+"]",startAjax(s,r,function(e){0==e.code})}if(e.fusion_add_cart_param="param="+i+"&pid="+e.pcba_pid+"&qty="+e.user_chose_data_temp.pcb_qty.value+"&price="+e.bomPrice.bom_and_pcb_price+"&file="+e.PCB_file_name+"&file_id="+e.PCB_file_id+"&bom_key="+e.bomToken+"&pcba_qty="+e.bomQty,""!==e.OTHER_file_name){var c='{"name":"'+e.OTHER_file_name+'","file_id":"'+e.OTHER_file_id+'","file_url":"'+e.OTHER_file_url+'"}';e.fusion_add_cart_param+="&drawing="+c}else{var c='{"name":"","file_id":"","file_url":""}';e.fusion_add_cart_param+="&drawing="+c}if(""!=o){e.isAddCart=!1,e.popData.isActionModalShow=!0,e.popData.actionModalText=o;var l={type:"addFusionCart"};return e.popData.actionModalOption=l,!1}}if(!window.fusion.commonState.isEditedGerberSize&&100==e.user_chose_data_temp.pcb_dimension_w.value&&100==e.user_chose_data_temp.pcb_dimension_h.value){e.isAddCart=!1,e.popData.isActionModalShow=!0,e.popData.isActionModalTitle="Do you still want to add to cart? ",e.popData.actionModalText="It seems that you did not modify the dimensions. <br> Please confirm that your board dimensions are 100mm*100mm. ";var l={type:"addFusionCart",cancelAction:"pcbDimensionsReset"};return e.popData.actionModalOption=l,!1}getQuery("id")&&(e.fusion_add_cart_param+="&opid="+getQuery("id")),$(".j-f-add").empty().append('<i class="fa fa-spinner"></i>'),e.isAddingCart=setTimeout(function(){clearTimeout(e.isAddingCart),e.addFusionToCart()},500)})},addFusionToCart:function(){var e=this;isOnline(function(t){if(e.isOpenBom&&!t.data.is_online)return void e.openLogin2();e.isOpenStencil&&e.addStencilToCart(e.fusion_add_cart_api);var i=window.location.href.indexOf("1-usd-for-3-pcbs.html")>-1;if(i){if(e.user_chose_data_temp.pcb_dimension_h.value>100||e.user_chose_data_temp.pcb_dimension_w.value>100)return $("#pcb-size-pop").show(),e.isAddCart=!1,!1;e.fusion_add_cart_param+="&project=4"}e.fusion_add_cart_param+="&pcba_expedited="+e.isExpedited+"&dfa_service="+e.isDfa,e.pcba_test&&(e.fusion_add_cart_param+="&test_id="+e.pcba_test_file_id);var a=e.fusion_add_cart_param.split("&"),o=a[1].split("=")[1],s=a[2].split("=")[1],r=a[3].split("=")[1];startAjax(e.fusion_add_cart_api,e.fusion_add_cart_param,function(t){e.isAddCart=!1,0==t.code?(dataLayer.push({event:"AddToCart-Fusion",ecommerce:{detail:{products:[{id:o,price:r,quantity:s}]}}}),e.popData.isFullModalShow=!0,e.popData.fullModalResultType="success"):(e.popData.isFullModalShow=!0,e.popData.fullModalResultType="fail"),setTimeout(function(){window.location.reload(!0)},2e3)})})},addStencilToCart:function(e){var t,i=this;if(""==i.stencilResult.stencil_file_name)return i.stencil_upload_data.is_warn=!0,window.fusion.positionWarining("#"+i.stencil_upload_data.type+"_upload"),!1;var a='{"dimension":'+i.stencilResult.s_dimensions_value+',"fiducial":'+i.stencilResult.s_fiducial.value+',"thickness":'+i.stencilResult.s_thickness.value+',"qty":'+i.stencilResult.s_qty+',"polishing":'+i.stencilResult.s_polishing.value+"}";t="pid="+i.stencil_pid+"&price="+i.stencilResult.stencil_price+"&file="+i.stencilResult.stencil_file_name+"&file_id="+i.stencilResult.stencil_file_number+"&param="+a,$.ajax({url:e,type:"post",async:!0,data:t,success:function(e){},fail:function(){}})},chooseExpedited:function(e){return!this.isOpenBom&&(e.nowType=this.nowPcbType,this.expeditedVal=e.value,void this.$broadcast("chooseExpedited",e))},reOrderGerber:function(){},reOrderBom:function(){this.openBom()},showErrorMsg:function(e){var t=this;String(t.bomErrorCode).indexOf(e.code)>-1&&(t.popData.isConfirmModalShow=!0,t.popData.confirmModalHtml="We can't read the BOM file, please modify the format according to the <a href='http://support.seeedstudio.com/knowledgebase/articles/1162186-why-can-not-recognize-my-bom-file' target='_blank' class='underline' title='BOM File Guideline'>BOM File Guideline.</a></br><span style='color:red;'>Error: "+e.msg+"</span>",t.popData.actionModalOption={type:"bomTips"})},resetBomResult:function(){this.isBomUploaded=!1,this.bomResultCount=0,this.bomEnquiryCount=0,this.bomProvideCount=0},set2017XmasEvent:function(){function e(e,i){t.xmas2017.remainingPrice=(e-1*t.xmas2017.fusionTotalOfCart).toFixed(2),t.xmas2017.discount=i,t.xmas2017.borderPrice=e}var t=this,i=parseFloat(1*this.xmas2017.fusionTotalOfCart+1*this.finalPrice);this.xmas2017.currentTotal=i,(i>1&&i<50||50==i)&&e(50,5),(i>50&&i<150||150==i)&&e(150,15),(i>150&&i<250||250==i)&&e(250,30),(i>250&&i<1500||1500==i)&&e(1500,200),(i>1500&&i<15e3||15e3==i)&&e(15e3,2500),(i>15e3&&i<3e4||3e4==i)&&e(3e4,5e3),i>3e4&&e(3e4,5e3)}},computed:{finalPrice:function(){this.currState;return this.isOpenBom&&!this.isOpenStencil?(price=Number(this.bomPrice.bom_and_pcb_price),$.formatFloatTo2(price)):!this.isOpenBom&&this.isOpenStencil?(price=Number(this.user_chose_data_temp.pcb_price)+Number(this.stencilResult.stencil_price),$.formatFloatTo2(price)):this.isOpenBom&&this.isOpenStencil?(price=Number(this.bomPrice.bom_and_pcb_price)+Number(this.stencilResult.stencil_price),$.formatFloatTo2(price)):(price=Number(this.user_chose_data_temp.pcb_price),$.formatFloatTo2(price))},finalPriceOrigin:function(){this.currState;return this.isOpenBom&&!this.isOpenStencil?(price=Number(this.bomPrice.bom_and_pcb_price_origin),$.formatFloatTo2(price)):!this.isOpenBom&&this.isOpenStencil?(price=Number(this.user_chose_data_temp.pcb_price)+Number(this.stencilResult.stencil_price),$.formatFloatTo2(price)):this.isOpenBom&&this.isOpenStencil?(price=Number(this.bomPrice.bom_and_pcb_price_origin)+Number(this.stencilResult.stencil_price),$.formatFloatTo2(price)):(price=Number(this.user_chose_data_temp.pcb_org_price),$.formatFloatTo2(price))},finalOrgPrice:function(){var e=(this.currState,this),t=(Number(this.finalPrice),Number(this.user_chose_data_temp.pcb_org_price));if(""!=t)return this.isOpenBom&&!this.isOpenStencil?Number(this.bomPrice.bom_and_pcb_rog_price).toFixed(2)==Number(e.finalPrice).toFixed(2)?"":$.formatFloatTo2(Number(e.user_chose_data_temp.pcb_org_price)+Number(this.bomPrice.bom_total_price)):!this.isOpenBom&&this.isOpenStencil?$.formatFloatTo2(Number(e.user_chose_data_temp.pcb_org_price)+Number(this.stencilResult.stencil_org_price)).toFixed(2)==Number(e.finalPrice).toFixed(2)?"":$.formatFloatTo2(Number(e.user_chose_data_temp.pcb_org_price)+Number(this.stencilResult.stencil_org_price)):this.isOpenBom&&this.isOpenStencil?$.formatFloatTo2(Number(this.bomPrice.bom_and_pcb_rog_price)+Number(this.stencilResult.stencil_org_price).toFixed(2))==Number(e.finalPrice).toFixed(2)?"":$.formatFloatTo2(Number(e.user_chose_data_temp.pcb_org_price)+Number(this.bomPrice.bom_total_price)+Number(this.stencilResult.stencil_org_price)):Number(e.user_chose_data_temp.pcb_org_price).toFixed(2)==Number(e.finalPrice).toFixed(2)?"":$.formatFloatTo2(Number(e.user_chose_data_temp.pcb_org_price))},finalBuildTimeCurr:function(){var e=this.user_chose_data_temp.pcb_build_time.toString().split(",").map(Math.ceil).join(" ~ ");return this.isOpenBom?this.bomPrice.bom_build_time_curr:e},finalBuildTimeOrig:function(){var e=this.user_chose_data_temp.pcb_build_time.toString().split(",").map(Math.ceil).join(" ~ ");return this.isOpenBom?this.bomPrice.bom_build_time_orig:e},finalWeight:function(){var e=Number(this.user_chose_data_temp.pcb_weight)/1e3,t=Number(this.bomPrice.bom_weight)/1e3,i=Number(this.stencilResult.stencil_weight)/1e3;return this.isOpenBom&&!this.isOpenStencil?$.formatFloatTo2(t):!this.isOpenBom&&this.isOpenStencil?$.formatFloatTo2(e+i):this.isOpenBom&&this.isOpenStencil?$.formatFloatTo2(t+i):$.formatFloatTo2(e)},finalExpeditedBuildTime:function(){this.currState;return this.bomPrice.expeditedBuildTime},finalDFABuildTime:function(){this.currState;return this.bomPrice.DFABuildTime},pcbOrgPriceByCurr:function(){this.currState;return this.user_chose_data_temp.pcb_org_price},BOMTotalPriceByCurr:function(){this.currState;return this.bomPrice.bomTotalCost},BOMTotalPriceByCurrOrigin:function(){this.currState;return this.bomPrice.bomTotalCostOrigin},BOMcomponentsCostByCurr:function(){this.currState;return this.bomPrice.componentsCost},BOMsetupCostByCurr:function(){this.currState;return this.bomPrice.setupCost},BOMassemblyCostByCurr:function(){this.currState;return this.bomPrice.assemblyCost},BOMconsumptiveMaterialCostByCurr:function(){this.currState;return this.bomPrice.consumptiveMaterialCost},BOMoperationFeePriceByCurr:function(){this.currState;return this.bomPrice.OperationFeePrice},BOMoperationFeePriceByCurrOrigin:function(){this.currState;return this.bomPrice.OperationFeePriceOrigin},BOMcomponentsCostByCurrOrigin:function(){this.currState;return this.bomPrice.componentsCostOrigin},BOMsetupCostByCurrOrigin:function(){this.currState;return this.bomPrice.setupCostOrigin},BOMassemblyCostByCurrOrigin:function(){this.currState;return this.bomPrice.assemblyCostOrigin},BOMconsumptiveMaterialCostByCurrOrigin:function(){this.currState;return this.bomPrice.consumptiveMaterialCostOrigin},BOMExpeditedCostByCurrOrigin:function(){this.currState;return this.bomPrice.expeditedCostOrigin},BOMDFACostByOrigin:function(){this.currState;return this.bomPrice.DFACostOrigin},BOMDFACostByCurr:function(){this.currState;return this.bomPrice.DFACostCurrent},stencilOrgPriceByCurr:function(){this.currState;return this.stencilResult.stencil_org_price},expeditedOptionData:function(){return""!=this.user_chose_data_temp.expedited_option_data?this.user_chose_data_temp.expedited_option_data:""},xmas2017PriceOfCart:function(){return this.xmas2017.fusionTotalOfCart}},watch:{finalPrice:function(){this.xmas2017.state&&this.set2017XmasEvent()},xmas2017PriceOfCart:function(){this.xmas2017.state&&this.set2017XmasEvent()}},events:{PCB_file_test:function(e){var t=this,i=JSON.parse(JSON.stringify(t.type_data_1));i.gerber_layer=6,i.gerber_width=200,i.gerber_length=300,t.type_data_1=i,delete i},PCB_file_data:function(e){var t=this;this.PCB_file_name=e.fileName,this.PCB_file_id=e.fileNumber;var i=JSON.parse(JSON.stringify(t.type_data_1)),a=JSON.parse(JSON.stringify(t.type_data_2)),o=JSON.parse(JSON.stringify(t.type_data_3)),s={};
s={gerber_width:e.gerberWidth.toFixed(1),gerber_length:e.gerberLength.toFixed(1)},t.$broadcast("setGerberData",s),t.type_data_1=i,t.type_data_2=a,t.type_data_3=o,i="",a="",o=""},OTHER_file_data:function(e){var t=this;this.OTHER_file_name=e.fileName,this.OTHER_file_id=e.fileNumber,this.OTHER_file_url=e.fileUrl;var i=JSON.parse(JSON.stringify(t.type_data_1)),a=JSON.parse(JSON.stringify(t.type_data_2)),o={};o={gerber_width:e.gerberWidth.toFixed(1),gerber_length:e.gerberLength.toFixed(1)},t.type_data_1=i,t.type_data_2=a,i="",a=""},BOM_file_ready:function(e){var t=this;return Number(e.code)?(t.popData.confirmModalTitle="",t.popData.isConfirmModalShow=!0,t.popData.confirmModalHtml="We can't read the BOM file, please modify the format according to the <a href='http://support.seeedstudio.com/knowledgebase/articles/1162186-why-can-not-recognize-my-bom-file' target='_blank' class='underline' title='BOM File Guideline'>BOM File Guideline.</a></br><span style='color:red;'>Error: "+e.msg+"</span>",t.popData.actionModalOption={type:"bomTips"},this.showErrorMsg(e),this.resetBomResult(),!1):(this.bomToken=e.bomToken,getQuery("id")&&getQuery("bomsource")&&(t.isBomUploaded=!0,t.getBomPrice()),void this.getBomDetail())},PCB_param_data:function(e){switch(Number(e.pcb_type)){case 1:this.user_choose_data_1=e;break;case 2:this.user_choose_data_2=e;break;case 3:this.user_choose_data_3=e}switch(Number(this.nowPcbType)){case 1:this.user_chose_data_temp=this.user_choose_data_1;break;case 2:this.user_chose_data_temp=this.user_choose_data_2;break;case 3:this.user_chose_data_temp=this.user_choose_data_3}this.isOpenBom&&this.isBomUploaded&&this.getBomPrice()},PCB_param_change:function(e){switch(Number(e.pcb_type)){case 1:this.type_data_1=e;break;case 2:this.type_data_2=e;break;case 3:this.type_data_3=e}},STENCIL_param_data:function(e){this.stencilResult=e},PCBA_test_plan_data:function(e){this.pcba_test_file_id=e.fileNumber},popComfirn:function(e){"addFusionCart"==e.type&&(this.isAddCart=!0,this.addFusionToCart(e.bom_api,e.bom_param)),"gotoFiveFree"==e.type&&(location.href="free-assembly-for-5-pcbs.html"),"bomEnquiryConfirm"==e.type&&this.resetBomResult(),"pcbaTest"==e.type&&(this.pcba_test=!0),"pcbaTest"==e.type&&(this.pcba_test=!0)},popCancel:function(e){"pcbDimensionsReset"==e.type&&(this.user_chose_data_temp.pcb_dimension_h.value=0,this.user_chose_data_temp.pcb_dimension_w.value=0,this.$broadcast("checkPcbDimensions",this.nowPcbType)),"gotoFiveFree"==e.type&&this.addFusionToCart(e.bom_api,e.bom_param),"pcbDimensionsReset"==e.cancelAction&&(this.user_chose_data_temp.pcb_dimension_h.value=0,this.user_chose_data_temp.pcb_dimension_w.value=0,this.$broadcast("checkPcbDimensions",this.nowPcbType))},PCB_reset_expedited_cost:function(){this.expeditedVal=2},commonLoginSuccess:function(e){var t=this;return"normal"==e.type?(t.is_login=!0,!1):void this.addFusionToCart()}}})},fusion.stencilAction=function(){new Vue({el:"#new-fusion",data:{stencil_upload_data:{type:"STENCIL",btn_text:"Add your gerber file",file_text:"Only accept zip or rar,Max 20MB",upload_text:"Uploading your file",api:seeedApiURL.gerberUpload+"?type=2&lang="+FUSION_LANG,id:"1391",is_warn:!1,progress_ccount:0,is_gerber:!1,tips:""},stencilResult:{},popData:{msg:"hello pc",isShow:!1,popText:"Seeed Fusion",popHTML:"",isFullModalShow:!1,fullModalResultType:"",fullModalText:"",isActionModalTitle:"",isActionModalShow:!1,isLoginActionModalShow:!1,actionModalText:""},currState:!1},ready:function(){var e=this;$("body").on("click",".j-f-curr",function(){e.currState=!e.currState})},methods:{addCart:function(){var e=this;isOnline(function(t){var i,a=seeedApiURL.addFusionToCart+getRealToken(t.data.is_online)+"&lang="+FUSION_LANG;if(""==e.stencilResult.stencil_file_name)return e.stencil_upload_data.is_warn=!0,!1;var o='{"dimension":'+e.stencilResult.s_dimensions_value+',"fiducial":'+e.stencilResult.s_fiducial.value+',"thickness":'+e.stencilResult.s_thickness.value+',"qty":'+e.stencilResult.s_qty+',"polishing":'+e.stencilResult.s_polishing.value+"}";i="pid=1391&price="+e.stencilResult.stencil_price+"&file="+e.stencilResult.stencil_file_name+"&file_id="+e.stencilResult.stencil_file_number+"&param="+o,$.ajax({url:a,type:"post",data:i,success:function(t){0==t.code?(e.popData.isFullModalShow=!0,e.popData.fullModalResultType="success"):(e.popData.isFullModalShow=!0,e.popData.fullModalResultType="fail"),setTimeout(function(){window.location.reload(!0)},2e3)},fail:function(){}})})}},computed:{stencilOrgPriceByCurr:function(){this.currState;return this.stencilResult.stencil_org_price},finalPrice:function(){this.currState;return this.stencilResult.stencil_price},finalOrgPrice:function(){this.currState;return this.stencilResult.stencil_org_price==this.stencilResult.stencil_price?"":this.stencilResult.stencil_org_price}},events:{STENCIL_param_data:function(e){this.stencilResult=e}}})};